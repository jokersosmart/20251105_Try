# Notion 進階公式實戰：專案管理、內容創作與個人財務三大場景應用

**目標受眾：** 熟悉 Notion 資料庫操作，希望利用公式實現複雜業務邏輯的進階使用者。
**核心概念：** 運用 Notion Formulas 2.0 的強大功能，實現跨屬性、跨資料庫的自動化計算與狀態追蹤。

---

## 導論：公式如何實現業務邏輯自動化

Notion 公式不僅能進行簡單的數學運算，更能透過 `if()`、`dateBetween()`、`map()` 和 `filter()` 等函數，將複雜的業務邏輯嵌入到資料庫中，實現高度自動化的工作流程。本指南將透過三個常見的應用場景，展示如何利用進階公式來提升效率。

---

## 一、專案管理：精準追蹤進度與狀態

在專案管理中，我們需要即時掌握專案的健康狀態、進度百分比以及是否逾期。

### 1. 自動判斷專案健康狀態 (多條件判斷與視覺化)

結合專案的**截止日期**、**狀態**和**子任務完成度**，自動輸出一個視覺化的健康狀態指標。

| 屬性名稱 | 屬性類型 | 說明 |
| :--- | :--- | :--- |
| `截止日期` | Date | 專案的預計完成日期 |
| `狀態` | Select | 專案的當前狀態 (例如：未開始、進行中、已完成) |
| `子任務完成度` | Rollup | 匯總所有子任務的完成百分比 (0-1) |
| `健康狀態` | Formula | 自動輸出視覺化狀態 |

**公式範例：**

```notion
// 1. 判斷是否已完成
if(prop("狀態") == "已完成", "✅ 已完成", 
  // 2. 判斷是否逾期
  if(prop("截止日期") < now() and prop("狀態") != "已完成", "🚨 嚴重逾期",
    // 3. 判斷是否即將逾期 (例如：剩餘不到 3 天)
    if(dateBetween(prop("截止日期"), now(), "days") < 3, "⚠️ 即將逾期",
      // 4. 判斷進度是否落後 (例如：完成度 < 50% 且剩餘天數 < 7 天)
      if(prop("子任務完成度") < 0.5 and dateBetween(prop("截止日期"), now(), "days") < 7, "🟡 進度落後",
        // 5. 正常進行中
        "🟢 正常進行"
      )
    )
  )
)
```

**公式解析：**
*   利用巢狀 `if()` 結構，從最優先的狀態（已完成）開始判斷，逐級向下。
*   `dateBetween(prop("截止日期"), now(), "days")` 用於計算剩餘天數，是判斷是否即將逾期的關鍵。
*   結合 `Rollup` 屬性（`子任務完成度`）和日期判斷，實現複雜的「進度落後」邏輯。

### 2. 自動計算專案總工時 (Rollup 與數學運算)

假設有一個「任務」資料庫，其中包含一個 `Number` 屬性 `預計工時 (小時)`。我們可以利用 `Relation` 和 `Rollup` 在「專案」資料庫中計算總工時。

**公式範例 (在「專案」資料庫的 Rollup 屬性中)：**

*   **關聯：** 連結到「任務」資料庫的屬性
*   **屬性：** 選擇「任務」資料庫中的 `預計工時 (小時)`
*   **計算方式：** 選擇 `Sum` (總和)

---

## 二、內容創作：自動化審核與發布流程

對於內容創作者而言，Notion 是絕佳的內容日曆和知識庫。公式可以幫助我們追蹤內容的生命週期。

### 1. 自動生成內容 ID (字串處理與日期)

為每篇內容自動生成一個獨一無二、且包含時間資訊的 ID，方便歸檔和搜尋。

| 屬性名稱 | 屬性類型 | 說明 |
| :--- | :--- | :--- |
| `建立日期` | Created time | 內容建立的日期 |
| `內容類型` | Select | 內容的類型 (例如：Blog, Video, Podcast) |
| `內容 ID` | Formula | 自動生成的 ID |

**公式範例：**

```notion
// 格式：[類型首字母]-[年-月-日]-[隨機碼]
prop("內容類型").slice(0, 1) + "-" + formatDate(prop("建立日期"), "YYYY-MM-DD") + "-" + slice(id(), 0, 4)
```

**公式解析：**
*   `prop("內容類型").slice(0, 1)`：提取內容類型名稱的第一個字母。
*   `formatDate(prop("建立日期"), "YYYY-MM-DD")`：將建立日期格式化為 `年-月-日`。
*   `slice(id(), 0, 4)`：提取頁面 ID 的前 4 個字元作為隨機碼，確保唯一性。

### 2. 內容審核狀態視覺化 (多條件判斷與 Emoji)

根據內容的**狀態**和**審核人**是否填寫，自動顯示審核流程的進度。

**公式範例：**

```notion
if(prop("狀態") == "已發布", "🚀 已發布",
  if(prop("狀態") == "審核中" and not empty(prop("審核人")), "👀 審核中",
    if(prop("狀態") == "草稿" and empty(prop("審核人")), "✍️ 待撰寫/待指派",
      "❓ 狀態異常"
    )
  )
)
```

---

## 三、個人財務：預算追蹤與支出分類

Notion 雖然不是專業的記帳軟體，但其資料庫功能結合公式，足以建立一個強大的個人財務追蹤系統。

### 1. 自動計算預算剩餘百分比 (數學運算與進度條)

假設有一個「預算」資料庫，其中包含 `預算金額` 和 `已支出金額` 兩個 `Number` 屬性。

| 屬性名稱 | 屬性類型 | 說明 |
| :--- | :--- | :--- |
| `預算金額` | Number | 該類別的總預算 |
| `已支出金額` | Number | 該類別的實際支出 (可透過 Rollup 匯總) |
| `剩餘進度` | Formula | 視覺化顯示預算使用情況 |

**公式範例：**

```notion
// 計算百分比 (0-1)
let(
  percent, prop("已支出金額") / prop("預算金額"),
  // 判斷是否超支
  if(percent > 1, "❌ 超支 " + format(percent * 100) + "%",
    // 正常進度條顯示
    slice("■■■■■■■■■■", 0, floor(percent * 10)) + slice("□□□□□□□□□□", 0, 10 - floor(percent * 10)) + " " + format(round(percent * 100)) + "%"
  )
)
```

**公式解析：**
*   `let(variable, value, expression)`：Notion Formulas 2.0 的新功能，用於定義變數 (`percent`)，避免重複計算，使公式更簡潔易讀。
*   `floor(percent * 10)`：計算要顯示多少個實心方塊 (■)。
*   `slice()`：用於截取字串，這裡用於截取實心和空心方塊，組成進度條。

### 2. 支出類別自動分類 (文字包含判斷)

當你從銀行匯入交易紀錄時，可以利用公式根據交易名稱中的關鍵字，自動將支出分類。

| 屬性名稱 | 屬性類型 | 說明 |
| :--- | :--- | :--- |
| `交易名稱` | Text | 銀行交易紀錄的名稱 |
| `自動分類` | Formula | 自動判斷支出類別 |

**公式範例：**

```notion
if(prop("交易名稱").includes("星巴克") or prop("交易名稱").includes("咖啡"), "☕ 咖啡/餐飲",
  if(prop("交易名稱").includes("台電") or prop("交易名稱").includes("水費"), "🏠 居家費用",
    if(prop("交易名稱").includes("Uber") or prop("交易名稱").includes("捷運"), "🚗 交通",
      "❓ 待分類"
    )
  )
)
```

**公式解析：**
*   `.includes("關鍵字")`：判斷 `交易名稱` 字串中是否包含特定關鍵字。
*   利用巢狀 `if()` 實現多重分類判斷。

---

## 總結與進階學習

這份教學展示了 Notion 公式在三大核心應用場景中的實戰能力。掌握這些進階技巧，能讓你的 Notion 系統從一個單純的筆記工具，升級為一個高度自動化的工作與生活管理平台。

| 場景 | 核心公式函數 | 實現效果 |
| :--- | :--- | :--- |
| **專案管理** | `dateBetween()`, `Rollup`, `if()` | 自動判斷專案健康狀態與進度。 |
| **內容創作** | `formatDate()`, `slice()`, `id()` | 自動生成內容 ID，追蹤審核流程。 |
| **個人財務** | `let()`, `slice()`, `.includes()` | 視覺化預算進度，自動分類支出。 |

**進階學習建議：**
*   **`let()` 函數**：熟練使用 `let()` 函數來定義變數，可以極大地簡化複雜公式的結構，提升可讀性和維護性。
*   **正規表達式 (Regex)**：對於更精確的文字處理和分類（例如，從交易名稱中提取數字），學習 `test()` 和 `replace()` 函數配合 Regex 是必不可少的。

---
**作者：** Manus AI
**日期：** 2025 年 11 月 05 日
